<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tournament Viewer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      font-family: ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
      background-color: #f9f9f9;
    }
    .team-A { background:#304d6d; color:#fff; }
    .team-B { background:#a67045; color:#fff; }
    .team-C { background:#a2ce3c; color:#fff; }
    .team-D { background:#198754; color:#fff; }
    .team-E { background:#d68a30; color:#fff; }
    .team-F { background:#6f42c1; color:#fff; }
    .team-0 { background: #304d6d; color: #fff; }  /* Deep blue-gray */
.team-1 { background: #a67045; color: #fff; }  /* Bronze brown */
.team-2 { background: #a2ce3c; color: #fff; }  /* Fresh lime green */
.team-3 { background: #198754; color: #fff; }  /* Emerald green */
.team-4 { background: #d68a30; color: #fff; }  /* Warm orange */
.team-5 { background: #6f42c1; color: #fff; }  /* Purple */
.team-6 { background: #007bff; color: #fff; }  /* Classic blue */
.team-7 { background: #dc3545; color: #fff; }  /* Bright crimson */
.team-8 { background: #17a2b8; color: #fff; }  /* Cyan-teal */
.team-9 { background: #fd7e14; color: #fff; }  /* Vibrant orange */
.team-10 { background: #20c997; color: #fff; } /* Mint green */
    .live-badge {
      background: red;
      color: #fff;
      font-weight: bold;
      animation: blink 1s infinite;
    }
    @keyframes blink {
      50% { opacity: 0.4; }
    }
  </style>
</head>
<body class="container py-3">

  <h2 class="text-center mb-4">üèê Tournament Viewer</h2>

  <!-- Rules -->
  <div class="card mb-4">
    <div class="card-body">
      <h5>üìú Rules</h5>
      <ul>
        <li>Double <strong>round robin</strong> across 4 teams.</li>
        <li>First Round is played to <strong>15 points</strong>.</li>
        <li>Second Round is played to <strong>10 points</strong>.</li>
        <li><strong>Top of the table</strong> wins the tournament.</li>
        <li>Tiebreakers:
          <ol>
            <li>Most Wins</li>
            <li>Points Difference (PF - PA)</li>
            <li>Head-to-Head result</li>
            <li>If still tied ‚Üí Joint Champions (must treat others üéâ)</li>
          </ol>
        </li>
      </ul>
    </div>
  </div>

  <!-- Live Matches -->
  <div id="live" class="mb-4"></div>

  <!-- Fixtures -->
  <div id="fixtures" class="mb-5"></div>

  <!-- Standings -->
  <h4 class="mb-3">üìä Standings</h4>
  <table class="table table-bordered table-striped text-center">
    <thead class="table-dark">
      <tr>
        <th>Team</th>
        <th>W</th>
        <th>L</th>
        <th>PF</th>
        <th>PA</th>
        <th>+/-</th>
      </tr>
    </thead>
    <tbody id="standings"></tbody>
  </table>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

  <script>
    // üîπ Your Firebase config
 const firebaseConfig = {
  apiKey: "AIzaSyDYvq9eXpYplV4qp65G106LJfHaBoPF23o",
  authDomain: "pedalschedule.firebaseapp.com",
  databaseURL: "https://pedalschedule-default-rtdb.firebaseio.com",
  projectId: "pedalschedule",
  storageBucket: "pedalschedule.firebasestorage.app",
  messagingSenderId: "46444074383",
  appId: "1:46444074383:web:4351f250d95fac4378a7fa",
  measurementId: "G-14CKBVRF1L"
};
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    var teamsClasses = {};
    var indicator = 0;
    // üîπ Helper: get team class
    function getTeamClass(name) {
      const hasClass = teamClasses[name] || false;
      if (!hasClass) {
        teamClasses[name] = `team-${indicator}`;
      }
      return teamClasses[name];
      /*if (name.includes("Fawad")) return "team-A";
      if (name.includes("Rauf")) return "team-B";
      if (name.includes("Usman")) return "team-C";
      if (name.includes("Mohsin")) return "team-D";
      if (name.includes("Salman")) return "team-E";
      if (name.includes("Zaheer")) return "team-F";
      return "";*/
    }

    // üîπ Render Fixtures
    function renderFixtures(fixtures) {
      const liveContainer = document.getElementById("live");
      const allContainer = document.getElementById("fixtures");
      liveContainer.innerHTML = "<h4>üî• Live Matches</h4>";
      allContainer.innerHTML = "<h4>üóì Fixtures & Results</h4>";

      let liveCount = 0;

      fixtures.forEach(match => {
        const card = document.createElement("div");
        card.className = "card mb-3";
        card.innerHTML = `
          <div class="card-body">
            <h6>Match ${match.id} - Court ${match.court}
              ${match.live ? "<span class='badge live-badge'>LIVE</span>" : ""}
            </h6>
            <div class="row">
              <div class="col-5 text-center p-2 ${getTeamClass(match.teamA)}">${match.teamA}</div>
              <div class="col-2 text-center">vs</div>
              <div class="col-5 text-center p-2 ${getTeamClass(match.teamB)}">${match.teamB}</div>
            </div>
            <div class="text-center mt-2">
              <strong>${match.scoreA} - ${match.scoreB}</strong>
            </div>
          </div>
        `;
        if (match.live) {
          liveContainer.appendChild(card);
          liveCount++;
        } else {
          allContainer.appendChild(card);
        }
      });

      if (liveCount === 0) {
        liveContainer.innerHTML += `<p class="text-muted">No live matches currently</p>`;
      }
    }

    // üîπ Render Standings
    function renderStandings(data) {
      const tbody = document.getElementById("standings");
      tbody.innerHTML = "";
      data.sort((a,b) => b.wins - a.wins || b.diff - a.diff);
      data.forEach(t => {
        tbody.innerHTML += `
          <tr>
            <td>${t.team}</td>
            <td>${t.wins}</td>
            <td>${t.losses}</td>
            <td>${t.pf}</td>
            <td>${t.pa}</td>
            <td>${t.diff}</td>
          </tr>`;
      });
    }

    // üîπ Live Sync
    db.ref("fixtures").on("value", snapshot => {
      renderFixtures(snapshot.val());
    });
    db.ref("standings").on("value", snapshot => {
      renderStandings(snapshot.val());
    });
  </script>
</body>
</html>
